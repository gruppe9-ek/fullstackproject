<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin login – Kino</title>
    <link rel="stylesheet" href="/assets/css/admin.css" />
</head>
<body class="auth">
<main class="auth-card">
    <h1>Admin login</h1>
    <p class="muted">Demo-login. Brugernavn og adgangskode er hardcodet.</p>

    <form id="loginForm" class="form">
        <label for="username">Brugernavn</label>
        <input id="username" name="username" autocomplete="username" required placeholder="admin" />

        <label for="password">Adgangskode</label>
        <input id="password" name="password" type="password" autocomplete="current-password" required placeholder="kinotest123" />

        <button class="btn btn-primary" type="submit">Log ind</button>
        <div id="error" class="error" hidden>Forkert brugernavn eller adgangskode.</div>
    </form>

    <div class="demo-hint">
        <strong>Demo-oplysninger</strong><br/>
        Brugernavn: <code>admin</code><br/>
        Adgangskode: <code>kinotest123</code>
    </div>
</main>

<script type="module">
    import { login, isAuthed } from "/assets/js/adminAuth.js";

    const form = document.getElementById("loginForm");
    const errorBox = document.getElementById("error");

    // Hvis man allerede er logget ind, gå direkte til /admin-dashboard.html
    if (isAuthed()) {
        const params = new URLSearchParams(location.search);
        const next = params.get("next") || "/admin-dashboard.html";
        location.replace(next);
    }

    form.addEventListener("submit", (e) => {
        e.preventDefault();
        errorBox.hidden = true;

        const username = document.getElementById("username").value.trim();
        const password = document.getElementById("password").value;

        if (login(username, password)) {
            const params = new URLSearchParams(location.search);
            const next = params.get("next") || "/admin-dashboard.html";
            location.replace(next);
        } else {
            errorBox.hidden = false;
        }
    });
</script>
</body>
</html>
